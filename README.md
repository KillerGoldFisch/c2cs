# C2CS

C to C# code generator. In go `.h` file, out come `.cs`.

## Background: Why?

### Problem

When creating applications with C# (especially games), it's sometimes necessary to dip down into C/C++ for better performance. However, maintaining the bindings becomes time consuming, error-prone, and in some cases quite tricky.

### Solution

Auto generate the bindings by parsing a C `.h` file, essentially transpiling the C API to C#. This includes all functions (`static`s in C#) and all types (`struct`s in C#). This is accomplished by using [libclang](https://clang.llvm.org/docs/Tooling.html) for C and [Roslyn](https://github.com/dotnet/roslyn) for C#. All naming is left as found in the header file of the C code.

## Developers: Building from Source

### Prerequisites

1. Download and install [.NET 5](https://dotnet.microsoft.com/download).
2. Clone the repository.

### Visual Studio / Rider / MonoDevelop

Open `./src/dotnet/C2CS.sln`

### Command Line Interface (CLI)

`dotnet build ./src/dotnet/C2CS.sln`

## Examples

#### Soloud: https://github.com/jarikomppa/soloud

Input:

```
-i
"/PATH/TO/soloud/include/soloud_c.h"
-o
"./soloud.cs"
-u
-l
"soloud"
```

```c
#ifndef SOLOUD_C_H_INCLUDED
#define SOLOUD_C_H_INCLUDED

#ifdef  __cplusplus
extern "C" {
#endif

/*
 * Soloud
 */
void Soloud_destroy(Soloud * aSoloud);
Soloud * Soloud_create();
int Soloud_init(Soloud * aSoloud);
int Soloud_initEx(Soloud * aSoloud, unsigned int aFlags /* = Soloud::CLIP_ROUNDOFF */, unsigned int aBackend /* = Soloud::AUTO */, unsigned int aSamplerate /* = Soloud::AUTO */, unsigned int aBufferSize /* = Soloud::AUTO */, unsigned int aChannels /* = 2 */);
void Soloud_deinit(Soloud * aSoloud);

...
```

Output:
```cs
// <auto-generated/>
// ReSharper disable All

using System.Runtime.InteropServices;

public static unsafe class soloud
{
    private const string LibraryName = "soloud";

    [DllImport(LibraryName)]
    public static extern void Soloud_destroy(void* aSoloud);

    [DllImport(LibraryName)]
    public static extern void* Soloud_create();

    [DllImport(LibraryName)]
    public static extern int Soloud_init(void* aSoloud);

    [DllImport(LibraryName)]
    public static extern int Soloud_initEx(void* aSoloud, uint aFlags, uint aBackend, uint aSamplerate, uint aBufferSize, uint aChannels);

    [DllImport(LibraryName)]
    public static extern void Soloud_deinit(void* aSoloud);

    ...
}
```

## License

PICG is licensed under the MIT License (`MIT`). See the [LICENSE](LICENSE) file for details.